#![no_main]
use libfuzzer_sys::fuzz_target;
use caramel_client::certs::verify_cert;


pub const VALID_KEY_DATA1: &str = "-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEAtHkqLKRbMYyyQ0diUtuLW/kpZdxIAji9fjdOK1RJXZz8GKiz
w2EF3vT0IQ3fdF4CW1eF6WFfdu8bpCAQBbkTHvMsqR9xuPiSlIw2RN3NOVxknTon
RS7VO+FSxfQSdSCPYpFITVCCrRpa7IK1Mp8C+RygM/rbC6aKxKREq8Kkw2PFkC74
s+Q+TL9VpnHWppUfDLf5n6e5Yu0l8hChz98btnbsMZw1PwtZn86oe5QFw6TjkepY
X7IXt3JUlvqVAMlI++6M7HRaS1qcigumvz+uK/yxpKQ3vLJnjfbdnilHDYJo+Atp
ziGt16NUJgv7GJb+nMzUBegMNqRqAH7uoZy9kQIDAQABAoIBAGP4+rPgF+RK3DUI
xh7AH2LDk3spm3oflFjmqha2ii2hWMUQLwR8KpRnfRUSakY8DXIr+bJejlOEAPva
BwYkj8MFUigdkxG0IP7I7QcZFyY/WD0AieB5IQYau4+MtOzNLKCdej/Z6Yman+OE
RHvWOf9lLBmfTNgXWae0l5XOLRdOr0N59a9BfNeyODt4CfrBJ7QaM0F/H2s0pFzL
Yce7zUtGHKLDLiD6AsiV8JpeG1Ab+MMKsU3RRShvww8AsP0OyDfJclUCi+9v3tNJ
6SnEad0qzWJ7PMEJwGTXhlYYDMXv7xgpdus9AOV+9HsuZGqOgsDu7VRoClxL1hy7
kfIhDUECgYEA3y64NfwpYokOcDVYNy8q9Ny55htClUH3P05JTwijNderQqrDvAeh
RKEGRR8wqt3TzQ1iPiq92ShUHQArw3UpIcXfc78rPO9ptOBU7aiF1ggAvk4MTjOf
I/uAP0b0COSqreajcCIHoQwiqqcJsuYzmc30LebrIttqPbad4xlkGxcCgYEAzwK9
GU1l7cBs+eEiKME8kO8ay3PLBAN8DY3kcTgTeJsTlrw2kDQVxnNh4NH1/NBxAuSi
XCZEx8x1zRdKBgZhf4HAufak1bOF2KKLT3VnOxO0WFX37oao+QEzomtNXf2Khd7M
2Ot7VRkgk+AEp3iLdzPQFiH/EFz9HiACVnbTNZcCgYBDJSYsr7mvuHZMkfABYkJ1
Orb/ILJuf1Moi6AIlBuuRj1zKDcNKep94EgnoZOdxHFFXsJw26EUZUqxEu0Xt/bw
/zwT8a7LfWf7EAbdHXduhifbGVYgbO1zAOZ7oxgmWM101k/Tm5lZ/XGsj+aeGR3r
JwhQiwmxCfwzpu5ndaslbwKBgQDF7FRokLvX6ZdIApzqYndKC5KO25NLrxk4zGWS
ao8TTRIZmLKChYocR81ZauXKZnDm1zr06BHzBeXLxWyc/hTSGHjwVIWdXRun2SFh
Q1sD/P79RpTalh2QljmMHRPHvdZn0HIDJIKzBmdDe3h3tqWBvyRBRRfdyUqpNumF
Se7+2QKBgAVYMQadBE2WSyzjOpzgIz/7xGA8y+DkYPcQelc7kSJvTEZFVDfMBktd
n2+g4Al8cu6674THUVHzzr5bmZJ/XQFT6KQhG1KRlCiikOFhgoaEUU2Sy6myon3K
2S5luFEBVaDbYLvPa4Jp1tjiIT4QggCtJnq9OV0yzI6SYvJZjslC
-----END RSA PRIVATE KEY-----
";

pub const VALID_CACERT_DATA1: &str = "-----BEGIN CERTIFICATE-----
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
Yegr7LgJOyQdp1MtVENfRFL5Ag==
-----END CERTIFICATE-----
";

pub const VALID_CRT_DATA1: &str = "-----BEGIN CERTIFICATE-----
MIIFWDCCA0CgAwIBAgIRALBtIYDbrxHqsV5+EcyPSKkwDQYJKoZIhvcNAQELBQAw
VjELMAkGA1UEBhMCU0UxEDAOBgNVBAoMB01vZGlvQUIxDzANBgNVBAsMBlNvbW1h
cjEkMCIGA1UEAwwbQ2FyYW1lbCBTaWduaW5nIENlcnRpZmljYXRlMB4XDTIwMDgx
MTA4NTAyMVoXDTIwMDgxMTExNTAyMVowXzELMAkGA1UEBhMCU0UxEDAOBgNVBAoM
B01vZGlvQUIxDzANBgNVBAsMBlNvbW1hcjEtMCsGA1UEAwwkMDZiYzRhYjItZGJh
Zi0xMWVhLTlhYmMtMDAxNTVkY2RlZThkMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAtHkqLKRbMYyyQ0diUtuLW/kpZdxIAji9fjdOK1RJXZz8GKizw2EF
3vT0IQ3fdF4CW1eF6WFfdu8bpCAQBbkTHvMsqR9xuPiSlIw2RN3NOVxknTonRS7V
O+FSxfQSdSCPYpFITVCCrRpa7IK1Mp8C+RygM/rbC6aKxKREq8Kkw2PFkC74s+Q+
TL9VpnHWppUfDLf5n6e5Yu0l8hChz98btnbsMZw1PwtZn86oe5QFw6TjkepYX7IX
t3JUlvqVAMlI++6M7HRaS1qcigumvz+uK/yxpKQ3vLJnjfbdnilHDYJo+AtpziGt
16NUJgv7GJb+nMzUBegMNqRqAH7uoZy9kQIDAQABo4IBFjCCARIwDAYDVR0TAQH/
BAIwADAgBgNVHSUBAf8EFjAUBggrBgEFBQcDAgYIKwYBBQUHAwEwLwYDVR0RBCgw
JoIkMDZiYzRhYjItZGJhZi0xMWVhLTlhYmMtMDAxNTVkY2RlZThkMB0GA1UdDgQW
BBTU5gum61amsaUbcJmylRFvkRK/cDCBjwYDVR0jBIGHMIGEgBRj5vOZQ0mGYOFn
sXR0HD9Vp7lt9KFapFgwVjELMAkGA1UEBhMCU0UxEDAOBgNVBAoMB01vZGlvQUIx
DzANBgNVBAsMBlNvbW1hcjEkMCIGA1UEAwwbQ2FyYW1lbCBTaWduaW5nIENlcnRp
ZmljYXRlghBYB3RCpwsR6pK4fhHMj0ipMA0GCSqGSIb3DQEBCwUAA4ICAQB07k2d
RHD1pOMBN+aR28+cXiVEhid++DoYZlTyvKd+WQJC8fuOkwLXrgxwxAHzKQtsZusw
kPiOOXy3/ErgW/H472dD/pL8m0UbpouoDSwq7JWUDJeCSg3urthxsk5hzdKZz99p
uq1khkb9cTgOfO9zj4ma8ViEOUusuDPuCgeA8BW6Og4LoK6Whh4JQRn46843nI6Z
SrV8SL0eBRxF/USIVL44Kj1ViS3kB3Z5k/jTMJfkiUpe0Uy2EDqueeWe0js/iXKc
K7x/qzeG7tuaG9cZ9CGRel+H/vYEs8wrqV24gfjD7JCh7CZD7kHJysziHaPZhbpb
aVb1b7FGOuxdXxlYz5UKBHsV7NJv6/FSFoIdtL5Eap7leQDN1vaF6xMQ7N99Ad/O
jCECWW9kXVC/pjkApDW33NZFP1w0+n70ImOhWeMCi73JvnKoFzBxIee4vyg9G8He
lAYL4HJyEAJ79YjU0oUQ6WQtgWCGeSovD/vwx3AYCtIkl6MK8LV7HkRT/NVZSFbT
FKnIekTZZJCmjeUtZpMAr1r5/PEujjZrzHcoJtMFyUK27sG7FoeRzMgANEJvxduf
C4VHIzwLWa2yuegl76iORIuPuUeUtZrWAk5Sv+LuydNYbxyVxJ3CIspU8x+RI1Bb
P2ymBLrZQdX4YRW97Jm2Ot61moaA+ySS1qSEoQ==
-----END CERTIFICATE-----
";


fuzz_target!(|cert_data: &[u8]| {
    // fuzzed code goes here
    let client_id = "06bc4ab2-dbaf-11ea-9abc-00155dcdee8d";
    let ca_cert_data = VALID_CACERT_DATA1.as_bytes().to_vec();
    let key_data = VALID_KEY_DATA1.as_bytes().to_vec();
    let _ = verify_cert(&cert_data, &ca_cert_data, &key_data, &client_id);
});
